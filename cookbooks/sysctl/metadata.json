{"name":"sysctl","version":"0.10.2","description":"Configures sysctl parameters","long_description":"# sysctl cookbook\n\n[![Cookbook Version](https://img.shields.io/cookbook/v/sysctl.svg?style=flat)](https://supermarket.chef.io/cookbooks/sysctl) [![Build Status](https://travis-ci.org/sous-chefs/sysctl.svg?branch=master)](https://travis-ci.org/sous-chefs/sysctl) [![License](https://img.shields.io/badge/license-Apache_2-blue.svg)](https://www.apache.org/licenses/LICENSE-2.0)\n\nSet [sysctl](http://en.wikipedia.org/wiki/Sysctl) system control parameters via Chef\n\n## Requirements\n\n### Platforms\n\n- Amazon Linux (Integration tested)\n- Debian/Ubuntu (Integration tested)\n- RHEL/CentOS (Integration tested)\n- openSUSE (Integration tested)\n- PLD Linux\n- Exherbo\n- Arch Linux\n- SLES\n- FreeBSD\n\n### Chef\n\n- 12.5+\n\n## Usage\n\nThere are two main ways to interact with the cookbook. This is via chef [attributes](http://docs.chef.io/attributes.html) or via the resource.\n\n### Cookbook Attributes\n\n- `node['sysctl']['params']` - A namespace for setting sysctl parameters.\n- `node['sysctl']['conf_dir']` - Specifies the sysctl.d directory to be used. Defaults to `/etc/sysctl.d` on the Debian and RHEL platform families, otherwise `nil`\n- `node['sysctl']['allow_sysctl_conf']` - Defaults to false. Using `conf_dir` is highly recommended. On some platforms that is not supported. For those platforms, set this to `true` and the cookbook will rewrite the `/etc/sysctl.conf` file directly with the params provided. Be sure to save any local edits of `/etc/sysctl.conf` before enabling this to avoid losing them.\n- `node['sysctl']['restart_procps']` - Defaults to true. Will allow the consumer of the cookbook to control whether or not to notify procps to restart sysctl to load the newly set values.\n- `node['sysctl']['ignore_error']` - Defaults is not set. If true, this will allow the consumer of the cookbook to control whether or not to utilize '-e' flag within actual sysctl command.\n\nNote: if `node['sysctl']['conf_dir']` is set to nil and `node['sysctl']['allow_sysctl_conf']` is not set, no config will be written\n\n### Setting Sysctl Parameters\n\n#### Using Attributes\n\nSetting variables in the `node['sysctl']['params']` hash will allow you to easily set common kernel parameters across a lot of nodes. All you need to do to have them loaded is to include `sysctl::apply` anywhere in your run list of the node. It is recommended to do this early in the run list, so any recipe that gets applied afterwards that may depend on the set parameters will find them to be set.\n\nThe attributes method is easiest to implement if you manage the kernel parameters at the system level opposed to a per cookbook level approach. The configuration will be written out when `sysctl::apply` gets run, which allows the parameters set to be persisted during a reboot.\n\n#### Examples\n\nSet `vm.swappiness` to 20 via attributes\n\n```ruby\n    node.default['sysctl']['params']['vm']['swappiness'] = 20\n\n    include_recipe 'sysctl::apply'\n```\n\n### Using resources\n\nThe `sysctl_param` resource can be called from wrapper or application cookbooks to immediately set the kernel parameter and cue the kernel parameter to be written out to the configuration file.\n\nThis also requires that your run_list include the `sysctl::default` recipe in order to persist the settings.\n\n### sysctl_param\n\n#### Actions\n\n- `:apply` (default)\n- `:remove`\n- `:nothing`\n\n#### Properties\n\n- key\n- value\n\n#### Examples\n\nSet vm.swappiness to 20 via sysctl_param resource\n\n```ruby\n    include_recipe 'sysctl::default'\n\n    sysctl_param 'vm.swappiness' do\n      value 20\n    end\n```\n\nRemove sysctl parameter and set net.ipv4.tcp_fin_timeout back to default\n\n```ruby\n    sysctl_param 'net.ipv4.tcp_fin_timeout' do\n      value 30\n      action :remove\n    end\n```\n\n### Ohai Plugin\n\nThe cookbook also includes an Ohai plugin that can be installed by adding `sysctl::ohai_plugin` to your run_list. This will populate `node['sys']` with automatic attributes that mirror the layout of `/proc/sys`.\n\nTo see Ohai plugin output manually, you can run `ohai -d /etc/chef/ohai/plugins sys` on the command line.\n\n## Additional Reading\n\nThere are a lot of different documents that talk about system control parameters, the hope here is to point to some of the most useful ones to provide more guidance as to what the possible kernel parameters are and what they mean.\n\n- [Chef OS Hardening Cookbook](https://github.com/dev-sec/chef-os-hardening)\n- [Linux Kernel Sysctl](https://www.kernel.org/doc/Documentation/sysctl/)\n- [Linux Kernel IP Sysctl](http://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt)\n- [Linux Performance links](http://www.brendangregg.com/linuxperf.html) by Brendan Gregg\n- [RHEL 7 Performance Tuning Guide](https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/pdf/Performance_Tuning_Guide/Red_Hat_Enterprise_Linux-7-Performance_Tuning_Guide-en-US.pdf) by Laura Bailey and Charlie Boyle\n- [Performance analysis & tuning of Red Hat Enterprise Linux at Red Hat Summit 2015 (video)](https://www.youtube.com/watch?v=ckarvGJE8Qc) slides [part 1](http://videos.cdn.redhat.com/summit2015/presentations/15284_performance-analysis-tuning-of-red-hat-enterprise-linux.pdf) by Jeremy Eder, D. John Shakshober, Larry Woodman and Bill Gray\n- [Performance Tuning Linux Instances on EC2 (Nov 2014)](http://www.brendangregg.com/blog/2015-03-03/performance-tuning-linux-instances-on-ec2.html) by Brendan Gregg\n- [Part 1: Lessons learned tuning TCP and Nginx in EC2 (Jan 2014)](http://engineering.chartbeat.com/2014/01/02/part-1-lessons-learned-tuning-tcp-and-nginx-in-ec2/)\n- [Tuning TCP For The Web at Velocity 2013 (video)](http://vimeo.com/70369211), [slides](http://cdn.oreillystatic.com/en/assets/1/event/94/Tuning%20TCP%20For%20The%20Web%20Presentation.pdf) by Jason Cook\n- [THE /proc FILESYSTEM (Jun 2009)](http://www.kernel.org/doc/Documentation/filesystems/proc.txt)\n\n## Development\n\nWe have written unit tests using [chefspec](http://code.sethvargo.com/chefspec/) and integration tests in [serverspec](http://serverspec.org/) executed via [test-kitchen](http://kitchen.ci). Much of the tooling around this cookbook is exposed via guard and test kitchen, so it is highly recommended to learn more about those tools. The easiest way to get started is to install the [Chef Development Kit](https://downloads.chef.io/chef-dk/)\n\n### Running tests\n\nThe following commands will run the tests:\n\n```bash\nchef exec bundle install\nchef exec cookstyle\nchef exec foodcritic .\nchef exec rspec\nchef exec kitchen test\n```\n\nPlease run the tests on any pull requests that you are about to submit and write tests for defects or new features to ensure backwards compatibility and a stable cookbook that we can all rely upon.\n\n### Running tests continuously with guard\n\nThis cookbook is also setup to run the checks while you work via the [guard gem](http://guardgem.org/).\n\n```bash\nbundle install\nbundle exec guard start\n```\n\n### ChefSpec Resource Matchers\n\nThe cookbook exposes a ChefSpec matcher to be used by wrapper cookbooks to test the cookbooks resource. See `libraries/matchers.rb` for basic usage.\n","maintainer":"Sous Chefs","maintainer_email":"help@sous-chefs.org","license":"Apache-2.0","platforms":{"amazon":">= 0.0.0","ubuntu":">= 14.04","debian":">= 7.0","centos":">= 6.0","scientific":">= 6.4","suse":">= 11.0","opensuseleap":">= 0.0.0","redhat":">= 0.0.0","pld":">= 0.0.0"},"dependencies":{"ohai":">= 4.0"},"recommendations":{},"suggestions":{},"conflicting":{},"providing":{},"replacing":{},"attributes":{},"groupings":{},"recipes":{},"source_url":"https://github.com/sous-chefs/sysctl","issues_url":"https://github.com/sous-chefs/sysctl/issues","chef_version":[[">= 12.5"]],"ohai_version":[]}